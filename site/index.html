<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MyoLearn</title>
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.3/angular-route.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
<style>
body {
	font: 20px Montserrat; sans-serif;
	line-height: 1.8;
	color: #f5f6f7;
}
p {
	font-size: 16px;
}
.margin {
	margin-bottom: 45px;
}
.bg-1 {
	background-color: #2c3e50;
	color: #ecf0f1;
}
.bg-2 {
	background-color: #3498db;
	color: #ecf0f1;
}
.bg-3 {
	background-color: #ecf0f1;
	color: black;
}
.bg-4 {
	background-color: #2c3e50;
	color: #ecf0f1;
}
.container-fluid {
	padding-top: 50px;
	padding-bottom: 50px;
}
</style>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script src="js/Chart.js"></script>
</head>
<body>
<div class="container-fluid bg-1 text-center">
	<h1 class="margin">MyoLearn</h1>
	<h3>Machine Learning with Myo</h3>
</div>
<div class="container-fluid bg-2 text-center">
	<h3 class="text-center" id="myostatus">Waiting for Myo to be connected...</h3>
</div>
<div class="container-fluid bg-3 text-center">
	<div class="col-sm-6">
		<canvas id="gyroChart" class="myGraph" width="400" height="400"></canvas>
	</div>
	<div class="col-sm-6">
		<canvas id="accelChart" class="myGraph" width="400" height="400"></canvas>
	</div>
</div>
<footer class="container-fluid bg-4 text-center">
	<p>Made by Dylan Ebert</p>
</footer>
<script>	
	var gyroctx = $('#gyroChart'),
		accelctx = $('#accelChart'),
		gyrodata = {
			labels: Array.apply(null, Array(20)).map(String.prototype.valueOf, ""),
			datasets: [
				{
					label: 'Gyroscope X',
					backgroundColor: 'rgba(52, 152, 219,0.2)',
					borderColor: 'rgba(41, 128, 185,1.0)',
					data: Array.apply(null, Array(20)).map(Number.prototype.valueOf, 0)
				},
				{
					label: 'Gyroscope Y',
					backgroundColor: 'rgba(46, 204, 113,0.2)',
					borderColor: 'rgba(39, 174, 96,1.0)',
					data: Array.apply(null, Array(20)).map(Number.prototype.valueOf, 0)
				},
				{
					label: 'Gyroscope Z',
					backgroundColor: 'rgba(26, 188, 156,0.2)',
					borderColor: 'rgba(22, 160, 133,1.0)',
					data: Array.apply(null, Array(20)).map(Number.prototype.valueOf, 0)
				}
			]
		},
		acceldata = {
			labels: Array.apply(null, Array(20)).map(String.prototype.valueOf, ""),
			datasets: [
				{
					label: 'Acceleration X',
					backgroundColor: 'rgba(52, 152, 219,0.2)',
					borderColor: 'rgba(41, 128, 185,1.0)',
					data: Array.apply(null, Array(20)).map(Number.prototype.valueOf, 0)
				},
				{
					label: 'Acceleration Y',
					backgroundColor: 'rgba(46, 204, 113,0.2)',
					borderColor: 'rgba(39, 174, 96,1.0)',
					data: Array.apply(null, Array(20)).map(Number.prototype.valueOf, 0)
				},
				{
					label: 'Acceleration Z',
					backgroundColor: 'rgba(26, 188, 156,0.2)',
					borderColor: 'rgba(22, 160, 133,1.0)',
					data: Array.apply(null, Array(20)).map(Number.prototype.valueOf, 0)
				}
			]
		}		
	var gyroChart = new Chart(gyroctx, {
		type: 'line',
		data: gyrodata,
		options: {
			scales: {
				xAxes: [{
					gridLines: {
						display: false
					},
				}],
				yAxes: [{
					ticks: {
						suggestedMin: -1000,
						suggestedMax: 1000
					}
				}]
			},
			elements: {
				point: {
					radius: 0
				}
			}
		}
	});				
	var accelChart = new Chart(accelctx, {
		type: 'line',
		data: acceldata,
		options: {
			scales: {
				xAxes: [{
					gridLines: {
						display: false
					},
				}],
				yAxes: [{
					ticks: {
						suggestedMin: -5,
						suggestedMax: 5
					}
				}]
			},
			elements: {
				point: {
					radius: 0
				}
			}
		}
	});
	
	var socket = io.connect();
	socket.on('myostatus', function(data) {
		$('#myostatus').text(data);
	});
	socket.on('myoout', function(data) {		
		//Update graphs
		for(i = 0; i < 3; i++) {
			gyrodata.datasets[i].data.shift();
			acceldata.datasets[i].data.shift();
			gyrodata.datasets[i].data.push(data.myoout[i+1]);
			acceldata.datasets[i].data.push(data.myoout[i+4]);
		}
		gyroChart.data = gyrodata;
		accelChart.data = acceldata;
		gyroChart.update();
		accelChart.update();
	});		
</script>
</body>
</html>